{"remainingRequest":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\ts-loader\\index.js??ref--14-3!C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\src\\lib\\upgrades.ts","dependencies":[{"path":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\src\\lib\\upgrades.ts","mtime":1627896646310},{"path":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0IF90eXBlb2YgZnJvbSAiQzovVXNlcnMvc2VhcmwvRG93bmxvYWRzL01hcnZlbCBDaGFtcGlvbnMvTWFydmVsQ2hhbXBpb25zUXVlc3RBcHAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL3R5cGVvZiI7CmltcG9ydCB7IHJhbmRvbUl0ZW1zRXhjbHVkaW5nLCBzaHVmZmxlIH0gZnJvbSAiQC9saWIvcmFuZG9tIjsKaW1wb3J0IHsgVXBncmFkZXNMaXN0LCBVcGdyYWRlc01hcCB9IGZyb20gIkAvY29uc3RzL3VwZ3JhZGVzIjsgLy8gR2l2ZW4gYSBsaXN0IG9mIGV4cGFuc2lvbnMgaXQgd2lsbCByZXR1cm4gYSBmdWxsIGxpc3Qgb2YgdXBncmFkZXMgdGhhdCBhcmUgY29tcGF0aWJsZQovLyB3aXRoIHRob3NlIGV4cGFuc2lvbnMKCmV4cG9ydCB2YXIgZ2V0RXhwYW5zaW9uc1VwZ3JhZGVzID0gZnVuY3Rpb24gZ2V0RXhwYW5zaW9uc1VwZ3JhZGVzKGV4cGFuc2lvbnMpIHsKICByZXR1cm4gVXBncmFkZXNMaXN0LmZpbHRlcihmdW5jdGlvbiAodXBncmFkZSkgewogICAgaWYgKHVwZ3JhZGUucmVxdWlyZXMgPT09IG51bGwpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHBhbnNpb25zLmxlbmd0aDsgaSsrKSB7CiAgICAgIGlmIChleHBhbnNpb25zW2ldLm5hbWUgPT09IHVwZ3JhZGUucmVxdWlyZXMpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBmYWxzZTsKICB9KTsKfTsKZXhwb3J0IHZhciBnZW5lcmF0ZVVwZ3JhZGVPcHRpb25zID0gZnVuY3Rpb24gZ2VuZXJhdGVVcGdyYWRlT3B0aW9ucyhwbGF5ZXIsIGV4cGFuc2lvbnMsIGNhdGVnb3JpZXMsIHBsYXllcnMpIHsKICB2YXIgcG9zc2libGVVcHMgPSBnZXRFeHBhbnNpb25zVXBncmFkZXMoZXhwYW5zaW9ucyk7IC8vIEZpbHRlciBiYXNlZCBvbiBjYXRlZ29yeQoKICBwb3NzaWJsZVVwcyA9IHBvc3NpYmxlVXBzLmZpbHRlcihmdW5jdGlvbiAodXBncmFkZSkgewogICAgcmV0dXJuIGNhdGVnb3JpZXMuaW5kZXhPZih1cGdyYWRlLmNhdGVnb3J5KSA+PSAwOwogIH0pOyAvLyBGaWx0ZXIgYmFzZWQgb24gaGVybwoKICBwb3NzaWJsZVVwcyA9IHBvc3NpYmxlVXBzLmZpbHRlcihmdW5jdGlvbiAodXBncmFkZSkgewogICAgaWYgKCF1cGdyYWRlLnJlcXVpcmVzSGVybykgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gdXBncmFkZS5yZXF1aXJlc0hlcm8gPT0gcGxheWVyLmhlcm8ubmFtZTsKICB9KTsgLy8gRmlsdGVyIG91dCB1cGdyYWRlcyB0aGF0IGNhbid0IGJlIHBhaXJlZCB3aXRoIGNlcnRhaW4gaGVyb3MKCiAgcG9zc2libGVVcHMgPSBwb3NzaWJsZVVwcy5maWx0ZXIoZnVuY3Rpb24gKHVwZ3JhZGUpIHsKICAgIGlmICghdXBncmFkZS5jb25mbGljdGluZ0hlcm9lcyB8fCB1cGdyYWRlLmNvbmZsaWN0aW5nSGVyb2VzLmxlbmd0aCA9PSAwKSB7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGxheWVycy5sZW5ndGg7IGkrKykgewogICAgICBpZiAodXBncmFkZS5jb25mbGljdGluZ0hlcm9lcy5pbmRleE9mKHBsYXllcnNbaV0uaGVyby5uYW1lKSA+PSAwKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWU7CiAgfSk7CiAgdmFyIG5hbWVzID0gcG9zc2libGVVcHMubWFwKGZ1bmN0aW9uICh4KSB7CiAgICByZXR1cm4geC5uYW1lOwogIH0pOwogIHZhciBleGlzdGluZyA9IHBsYXllci51cGdyYWRlcy5tYXAoZnVuY3Rpb24gKHgpIHsKICAgIHJldHVybiB4Lm5hbWU7CiAgfSk7CiAgdmFyIHNlbGVjdGVkID0gcmFuZG9tSXRlbXNFeGNsdWRpbmcoMywgbmFtZXMsIGV4aXN0aW5nKTsKICB2YXIgdXBncmFkZXMgPSBzZWxlY3RlZC5tYXAoZnVuY3Rpb24gKG5hbWUpIHsKICAgIHZhciB1cCA9IFVwZ3JhZGVzTWFwW25hbWVdOyAvLyBURVNUSU5HCiAgICAvLyBZb3UgY2FuIHR1cm4gdGhpcyBvbiB0byBtYWtlIHN1cmUgdXBncmFkZSBkZXNjcmlwdGlvbnMgYXJlIGRpc3BsYXkgY2FyZWZ1bGx5CiAgICAvL3VwLmxldmVsID0gdXAubWF4TGV2ZWwtMQogICAgLy91cC5sZXZlbCA9IGdldFJhbmRvbUludCgxLCB1cC5tYXhMZXZlbCB8fCAxKQoKICAgIHJldHVybiB1cDsKICB9KTsKICBzaHVmZmxlKHVwZ3JhZGVzKTsKICByZXR1cm4gdXBncmFkZXM7Cn07CmV4cG9ydCBmdW5jdGlvbiBkZWZDYXRlZ29yeShkZWYpIHsKICBpZiAoZGVmLmNhdGVnb3J5KSB7CiAgICByZXR1cm4gZGVmLnJlcXVpcmVzSGVybyA/ICdIZXJvaWMnIDogZGVmLmNhdGVnb3J5OwogIH0KCiAgcmV0dXJuIGRlZi5jYXRlZ29yeSB8fCAnR2VuZXJhbCc7Cn0KZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlVXBncmFkZUNhcmQoZGVmKSB7CiAgdmFyIGNhdGVnb3J5ID0gZGVmQ2F0ZWdvcnkoZGVmKTsKICB2YXIgbWF4TGV2ZWwgPSAxOwoKICBpZiAodHlwZW9mIGRlZi5jb3BpZXMgIT0gInVuZGVmaW5lZCIpIHsKICAgIG1heExldmVsID0gZGVmLmNvcGllczsKICB9CgogIHZhciB1cGdyYWRlID0gewogICAgbmFtZTogZGVmLm5hbWUsCiAgICBsZXZlbDogMSwKICAgIGRlc2NyaXB0aW9uOiBmdW5jdGlvbiBkZXNjcmlwdGlvbigpIHsKICAgICAgdmFyIGFydGljbGUgPSBkZWYuYXJ0aWNsZSA/IGRlZi5hcnRpY2xlICsgJyAnIDogJyc7CiAgICAgIHZhciBhdHRhY2hlZCA9IGRlZi5hdHRhY2hlZCA/ICcgYXR0YWNoZWQgdG8geW91ciBoZXJvJyA6ICcnOwogICAgICB2YXIgZXhoYXVzdGVkID0gZGVmLmV4aGF1c3RlZCA/ICcgRXhoYXVzdCAnICsgZGVmLmNhcmQgKyAnLicgOiAnJzsKICAgICAgdmFyIG1zZyA9ICI8c3Ryb25nPlNldHVwOjwvc3Ryb25nPiBQdXQgIi5jb25jYXQoYXJ0aWNsZSwgIjxzdHJvbmc+IikuY29uY2F0KGRlZi5jYXJkLCAiPC9zdHJvbmc+IGludG8gcGxheSIpLmNvbmNhdChhdHRhY2hlZCwgIi4iKS5jb25jYXQoZXhoYXVzdGVkKTsKICAgICAgdmFyIGV4dHJhcyA9IHRoaXMubGV2ZWwgLSAxOwoKICAgICAgaWYgKGV4dHJhcyA+IDApIHsKICAgICAgICBpZiAoZXh0cmFzID09IDEpIHsKICAgICAgICAgIG1zZyArPSAnIFJlcGVhdCBmb3IgYW5vdGhlciAnICsgZGVmLmNhcmQgKyAnLic7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG1zZyArPSAnIFJlcGVhdCAnICsgZXh0cmFzICsgJyB0aW1lcy4nOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG1zZzsKICAgIH0sCiAgICBsZXZlbFVwTWVzc2FnZTogZnVuY3Rpb24gbGV2ZWxVcE1lc3NhZ2UoKSB7CiAgICAgIGlmIChtYXhMZXZlbCA9PSAxKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICByZXR1cm4gJ1B1dCBhbiBleHRyYSBjb3B5IGludG8gcGxheS4nOwogICAgfSwKICAgIHJlcXVpcmVzOiBkZWYucmVxdWlyZXMsCiAgICByZXF1aXJlc0hlcm86IGRlZi5yZXF1aXJlc0hlcm8sCiAgICBtYXhMZXZlbDogbWF4TGV2ZWwsCiAgICBjYXRlZ29yeTogY2F0ZWdvcnkKICB9OwogIHJldHVybiB1cGdyYWRlOwp9CmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUV4aGF1c3RlZENhcmRJblBsYXkoZGVmKSB7CiAgdmFyIGNhdGVnb3J5ID0gZGVmQ2F0ZWdvcnkoZGVmKTsKICB2YXIgdXBncmFkZSA9IHsKICAgIG5hbWU6IGRlZi5uYW1lLAogICAgbGV2ZWw6IDEsCiAgICBkZXNjcmlwdGlvbjogZnVuY3Rpb24gZGVzY3JpcHRpb24oKSB7CiAgICAgIHZhciBkZXNjID0gY2FyZEluUGxheShkZWYuY2FyZCwgdGhpcy5sZXZlbCA9PSAxLCBkZWYuYXJ0aWNsZSwgZGVmLnRoZXkpOwogICAgICByZXR1cm4gZGVzYzsKICAgIH0sCiAgICByZXF1aXJlczogZGVmLnJlcXVpcmVzLAogICAgbGV2ZWxVcE1lc3NhZ2U6IGZ1bmN0aW9uIGxldmVsVXBNZXNzYWdlKCkgewogICAgICByZXR1cm4gIkRvZXMgbm90IGVudGVyIHBsYXkgZXhoYXVzdGVkIjsKICAgIH0sCiAgICBtYXhMZXZlbDogZGVmLm1heExldmVsIHx8IDIsCiAgICByZXF1aXJlc0hlcm86IGRlZi5yZXF1aXJlc0hlcm8sCiAgICBjYXRlZ29yeTogY2F0ZWdvcnkKICB9OwogIHJldHVybiB1cGdyYWRlOwp9CmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUNvdW50ZXJDYXJkSW5QbGF5KGRlZikgewogIHZhciBtYXhMZXZlbCA9IGRlZi5tYXhMZXZlbDsgLy8gSWYgbm8gbWF4IGxldmVsIGhhcyBiZWVuIHByb3ZpZGVkLCBidXQgd2UgaGF2ZSBkZWZpbmVkIHRoZSBleHRyYSBjb3VudGVycyB5b3Ugd291bGQKICAvLyBnZXQgYXQgZWFjaCBsZXZlbCwgdGhlbiB3ZSBjYW4gdXNlIHRoYXQgdG8gZGV0ZXJtaW5lIG1heCBsZXZlbAoKICBpZiAoIWRlZi5tYXhMZXZlbCAmJiBkZWYuZXh0cmFDb3VudGVycyAmJiBfdHlwZW9mKGRlZi5leHRyYUNvdW50ZXJzKSA9PSAnb2JqZWN0JykgewogICAgZGVmLm1heExldmVsID0gT2JqZWN0LmtleXMoZGVmLmV4dHJhQ291bnRlcnMpLmxlbmd0aDsKICB9CgogIHZhciB1cGdyYWRlID0gewogICAgbmFtZTogZGVmLm5hbWUsCiAgICBnZXRFeHRyYUNvdW50ZXJzOiBmdW5jdGlvbiBnZXRFeHRyYUNvdW50ZXJzKGxldmVsKSB7CiAgICAgIHJldHVybiBkZWYuZXh0cmFDb3VudGVyc1tsZXZlbF0gfHwgMDsKICAgIH0sCiAgICBleHRyYUNvdW50ZXJzTXNnOiBmdW5jdGlvbiBleHRyYUNvdW50ZXJzTXNnKGV4dHJhQ291bnRlcnMpIHsKICAgICAgdmFyIGV4dHJhID0gZXh0cmFDb3VudGVycyA9PSAxID8gJycgOiBleHRyYUNvdW50ZXJzICsgJyAnOwoKICAgICAgaWYgKGV4dHJhQ291bnRlcnMgPT0gMSkgewogICAgICAgIHJldHVybiAiUHV0IGFuIGV4dHJhIGNvdW50ZXIgb24gIiArIGRlZi5wcm9ub3VuICsgJy4nOwogICAgICB9CgogICAgICByZXR1cm4gJ1B1dCAnICsgZXh0cmEgKyAnIGV4dHJhIGNvdW50ZXJzIG9uICcgKyBkZWYucHJvbm91biArICcuJzsKICAgIH0sCiAgICBsZXZlbDogMSwKICAgIG1heExldmVsOiBkZWYubWF4TGV2ZWwsCiAgICBkZXNjcmlwdGlvbjogZnVuY3Rpb24gZGVzY3JpcHRpb24oKSB7CiAgICAgIHZhciBkZXNjID0gY2FyZEluUGxheShkZWYuY2FyZCwgZGVmLmV4aGF1c3RlZCwgZGVmLmFydGljbGUsIGRlZi50aGV5KTsKICAgICAgdmFyIGV4dHJhQ291bnRlcnMgPSB0aGlzLmdldEV4dHJhQ291bnRlcnModGhpcy5sZXZlbCk7CgogICAgICBpZiAoZXh0cmFDb3VudGVycyA+IDApIHsKICAgICAgICBkZXNjICs9ICcgJyArIHRoaXMuZXh0cmFDb3VudGVyc01zZyhleHRyYUNvdW50ZXJzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGRlc2M7CiAgICB9LAogICAgcmVxdWlyZXM6IGRlZi5yZXF1aXJlcywKICAgIHJlcXVpcmVzSGVybzogZGVmLnJlcXVpcmVzSGVybywKICAgIGxldmVsVXBNZXNzYWdlOiBmdW5jdGlvbiBsZXZlbFVwTWVzc2FnZSgpIHsKICAgICAgdmFyIGN1cnJlbnRDb3VudGVycyA9IHRoaXMuZ2V0RXh0cmFDb3VudGVycyh0aGlzLmxldmVsKTsKICAgICAgdmFyIG5ld0NvdW50ZXJzID0gdGhpcy5nZXRFeHRyYUNvdW50ZXJzKHRoaXMubGV2ZWwgKyAxKTsKCiAgICAgIGlmIChjdXJyZW50Q291bnRlcnMgPT0gMCAmJiBuZXdDb3VudGVycyA+IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5leHRyYUNvdW50ZXJzTXNnKG5ld0NvdW50ZXJzKTsKICAgICAgfQoKICAgICAgcmV0dXJuICJFeHRyYSBjb3VudGVyczogIi5jb25jYXQoY3VycmVudENvdW50ZXJzLCAiIGJlY29tZXMgPHN0cm9uZz4iKS5jb25jYXQobmV3Q291bnRlcnMsICI8L3N0cm9uZz4iKTsKICAgIH0sCiAgICBjYXRlZ29yeTogZGVmQ2F0ZWdvcnkoZGVmKSwKICAgIGNvbmZsaWN0aW5nSGVyb2VzOiBkZWYuY29uZmxpY3RpbmdIZXJvZXMKICB9OwogIHJldHVybiB1cGdyYWRlOwp9CmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUFsbHlDYXJkKGRlZikgewogIHZhciB1cGdyYWRlID0gewogICAgbmFtZTogZGVmLm5hbWUsCiAgICBnZXREYW1hZ2VDb3VudGVyczogZnVuY3Rpb24gZ2V0RGFtYWdlQ291bnRlcnMobGV2ZWwpIHsKICAgICAgaWYgKGRlZi5sZXZlbHMgJiYgZGVmLmxldmVsc1tsZXZlbCAtIDFdKSB7CiAgICAgICAgcmV0dXJuIGRlZi5sZXZlbHNbbGV2ZWwgLSAxXS5kYW1hZ2UgfHwgMDsKICAgICAgfQoKICAgICAgcmV0dXJuIDA7CiAgICB9LAogICAgZGFtYWdlQ291bnRlcnNNc2c6IGZ1bmN0aW9uIGRhbWFnZUNvdW50ZXJzTXNnKGNvdW50ZXJzKSB7CiAgICAgIGlmIChjb3VudGVycyA9PSAwKSB7CiAgICAgICAgcmV0dXJuICcnOwogICAgICB9CgogICAgICByZXR1cm4gZGVmLmNhcmQgKyAiIHN0YXJ0cyB3aXRoICIuY29uY2F0KGNvdW50ZXJzLCAiIGRhbWFnZSBjb3VudGVyIikgKyAoY291bnRlcnMgPT0gMSA/ICcnIDogJ3MnKSArICcgb24gJyArIGRlZi5wcm9ub3VuICsgJy4nOwogICAgfSwKICAgIGxldmVsOiAxLAogICAgbWF4TGV2ZWw6IGRlZi5sZXZlbHMubGVuZ3RoLAogICAgZGVzY3JpcHRpb246IGZ1bmN0aW9uIGRlc2NyaXB0aW9uKCkgewogICAgICB2YXIgZGVzYyA9ICI8c3Ryb25nPlNldHVwOjwvc3Ryb25nPiBQdXQgPHN0cm9uZz4iLmNvbmNhdChkZWYuY2FyZCwgIjwvc3Ryb25nPiBpbnRvIHBsYXkgdW5kZXIgeW91ciBjb250cm9sLiIpOwoKICAgICAgaWYgKGRlZi5sZXZlbHNbdGhpcy5sZXZlbCAtIDFdLmV4aGF1c3RlZCkgewogICAgICAgIGRlc2MgKz0gIiAiLmNvbmNhdChkZWYuY2FyZCwgIiBlbnRlcnMgcGxheSBleGhhdXN0ZWQuIik7CiAgICAgIH0KCiAgICAgIHZhciBkbWcgPSB0aGlzLmdldERhbWFnZUNvdW50ZXJzKHRoaXMubGV2ZWwpOwoKICAgICAgaWYgKGRtZyA+IDApIHsKICAgICAgICBkZXNjICs9ICcgJyArIHRoaXMuZGFtYWdlQ291bnRlcnNNc2coZG1nKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNUb3VnaCh0aGlzLmxldmVsKSkgewogICAgICAgIGRlc2MgKz0gIiBHaXZlICIuY29uY2F0KGRlZi5wcm9ub3VuLCAiIGEgVG91Z2ggc3RhdHVzIGNhcmQuIik7CiAgICAgIH0KCiAgICAgIHJldHVybiBkZXNjOwogICAgfSwKICAgIGlzVG91Z2g6IGZ1bmN0aW9uIGlzVG91Z2gobGV2ZWwpIHsKICAgICAgcmV0dXJuIGRlZi5sZXZlbHNbbGV2ZWwgLSAxXS50b3VnaCB8fCBmYWxzZTsKICAgIH0sCiAgICByZXF1aXJlczogZGVmLnJlcXVpcmVzLAogICAgcmVxdWlyZXNIZXJvOiBkZWYucmVxdWlyZXNIZXJvLAogICAgbGV2ZWxVcE1lc3NhZ2U6IGZ1bmN0aW9uIGxldmVsVXBNZXNzYWdlKCkgewogICAgICB2YXIgY3VycmVudCA9IGRlZi5sZXZlbHNbdGhpcy5sZXZlbCAtIDFdOwogICAgICB2YXIgbmV4dCA9IGRlZi5sZXZlbHNbdGhpcy5sZXZlbF07CiAgICAgIHZhciBwYXJ0cyA9IFtdOwoKICAgICAgaWYgKGN1cnJlbnQuZGFtYWdlICE9IG5leHQuZGFtYWdlKSB7CiAgICAgICAgcGFydHMucHVzaCgiU3RhcnRpbmcgRGFtYWdlOiAiLmNvbmNhdChjdXJyZW50LmRhbWFnZSwgIiBiZWNvbWVzIDxzdHJvbmc+IikuY29uY2F0KG5leHQuZGFtYWdlLCAiPC9zdHJvbmc+IikpOwogICAgICB9CgogICAgICBpZiAobmV4dC50b3VnaCkgewogICAgICAgIHBhcnRzLnB1c2goJ0dhaW5zIGEgVG91Z2ggc3RhdHVzIGNhcmQuJyk7CiAgICAgIH0KCiAgICAgIGlmIChjdXJyZW50LmV4aGF1c3RlZCAmJiAhbmV4dC5leGhhdXN0ZWQpIHsKICAgICAgICBwYXJ0cy5wdXNoKCdEb2VzIG5vdCBlbnRlciBwbGF5IGV4aGF1c3RlZC4nKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHBhcnRzLmpvaW4oJyAnKTsKICAgIH0sCiAgICBjYXRlZ29yeTogZGVmQ2F0ZWdvcnkoZGVmKSwKICAgIGNvbmZsaWN0aW5nSGVyb2VzOiBkZWYuY29uZmxpY3RpbmdIZXJvZXMKICB9OwogIHJldHVybiB1cGdyYWRlOwp9CmV4cG9ydCBmdW5jdGlvbiBjYXJkSW5QbGF5KGNhcmQpIHsKICB2YXIgZXhoYXVzdGVkID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKICB2YXIgYXJ0aWNsZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogJ2EnOwogIHZhciB0aGV5ID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiAnSXQnOwogIHZhciBhcnRpY2xlTXNnID0gYXJ0aWNsZSA/IGFydGljbGUgKyAnICcgOiAnJzsKICB2YXIgZGVzYyA9ICI8c3Ryb25nPlNldHVwOjwvc3Ryb25nPiBQdXQgIi5jb25jYXQoYXJ0aWNsZU1zZywgIjxzdHJvbmc+IikuY29uY2F0KGNhcmQsICI8L3N0cm9uZz4gaW50byBwbGF5IHVuZGVyIHlvdXIgY29udHJvbC4iKTsKCiAgaWYgKGV4aGF1c3RlZCkgewogICAgZGVzYyArPSAiICIuY29uY2F0KHRoZXksICIgZW50ZXJzIHBsYXkgZXhoYXVzdGVkLiIpOwogIH0KCiAgcmV0dXJuIGRlc2M7Cn0KZXhwb3J0IGZ1bmN0aW9uIGxldmVsVXBNZXNzYWdlSW5jcmVhc2UobnVtQmVmb3JlLCBudW1BZnRlciwgbnVtT2ZXaGF0LCBwbHVyYWwpIHsKICBpZiAoIXBsdXJhbCkgewogICAgcGx1cmFsID0gbnVtT2ZXaGF0ICsgJ3MnOwogIH0KCiAgcmV0dXJuICIiLmNvbmNhdChudW1CZWZvcmUsICIgIikuY29uY2F0KG51bUJlZm9yZSA9PSAxID8gbnVtT2ZXaGF0IDogcGx1cmFsLCAiIGJlY29tZXMgPHN0cm9uZz4iKS5jb25jYXQobnVtQWZ0ZXIsICIgIikuY29uY2F0KHBsdXJhbCwgIjwvc3Ryb25nPiIpOwp9"},{"version":3,"sources":["C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\searl\\Downloads\\Marvel Champions\\MarvelChampionsQuestApp\\src\\lib\\upgrades.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n\tCardInPlayExtraCounters,\r\n\tDefinition,\r\n\tExhaustedCard, MinionCard,\r\n\tUpgrade,\r\n\tUpgradeCard,\r\n\tUpgradeCategory\r\n} from \"@/types/upgrade\";\r\nimport {getRandomInt, randomItemsExcluding, shuffle} from \"@/lib/random\";\r\nimport {UpgradesList, UpgradesMap} from \"@/consts/upgrades\";\r\nimport {Player} from \"@/types/player\";\r\nimport {Expansion} from \"@/types/expansion\";\r\n\r\n// Given a list of expansions it will return a full list of upgrades that are compatible\r\n// with those expansions\r\nexport const getExpansionsUpgrades = (expansions: Expansion[]) : Upgrade[] => {\r\n\treturn UpgradesList.filter((upgrade : Upgrade) => {\r\n\t\tif (upgrade.requires === null) {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\tfor (var i = 0; i < expansions.length; i++) {\r\n\t\t\tif (expansions[i].name === upgrade.requires) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false\r\n\t})\r\n}\r\n\r\nexport const generateUpgradeOptions  = (player: Player, expansions: Expansion[], categories: UpgradeCategory[], players: Player[]) : Upgrade[] => {\r\n\tlet possibleUps = getExpansionsUpgrades(expansions)\r\n\r\n\t// Filter based on category\r\n\tpossibleUps = possibleUps.filter((upgrade: Upgrade) => {\r\n\t\treturn categories.indexOf(upgrade.category) >= 0\r\n\t})\r\n\r\n\t// Filter based on hero\r\n\tpossibleUps = possibleUps.filter((upgrade: Upgrade) => {\r\n\t\tif (!upgrade.requiresHero) {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn upgrade.requiresHero == player.hero.name\r\n\t})\r\n\r\n\t// Filter out upgrades that can't be paired with certain heros\r\n\tpossibleUps = possibleUps.filter((upgrade: Upgrade) => {\r\n\t\tif (!upgrade.conflictingHeroes || upgrade.conflictingHeroes.length == 0) {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\tfor (let i = 0; i < players.length; i++) {\r\n\t\t\tif (upgrade.conflictingHeroes.indexOf(players[i].hero.name) >= 0) {\r\n\t\t\t\treturn false\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn true\r\n\t})\r\n\r\n\tconst names = possibleUps.map(x => x.name)\r\n\tconst existing =  player.upgrades.map(x => x.name)\r\n\r\n\tconst selected = randomItemsExcluding<string>(3, names, existing)\r\n\tconst upgrades = selected.map((name) : Upgrade => {\r\n\t\tconst up = UpgradesMap[name]\r\n\r\n\t\t// TESTING\r\n\t\t// You can turn this on to make sure upgrade descriptions are display carefully\r\n\t\t//up.level = up.maxLevel-1\r\n\t\t//up.level = getRandomInt(1, up.maxLevel || 1)\r\n\r\n\t\treturn up\r\n\t})\r\n\tshuffle(upgrades)\r\n\treturn upgrades\r\n}\r\n\r\n\r\nexport function defCategory (def: Definition) : UpgradeCategory {\r\n\tif (def.category) {\r\n\t\treturn def.requiresHero ? 'Heroic' : def.category\r\n\t}\r\n\r\n\treturn def.category || 'General'\r\n}\r\n\r\nexport function generateUpgradeCard (def: UpgradeCard) : Upgrade {\r\n\tconst category = defCategory(def)\r\n\tlet maxLevel = 1\r\n\tif (typeof def.copies != \"undefined\") {\r\n\t\tmaxLevel = def.copies\r\n\t}\r\n\tconst upgrade = {\r\n\t\tname: def.name,\r\n\t\tlevel: 1,\r\n\t\tdescription () {\r\n\t\t\tconst article = def.article ? (def.article + ' ') : ''\r\n\t\t\tconst attached = def.attached ? ' attached to your hero' : ''\r\n\t\t\tconst exhausted = def.exhausted ? ' Exhaust ' + def.card +'.': ''\r\n\t\t\tlet msg = `<strong>Setup:</strong> Put ${article}<strong>${def.card}</strong> into play${attached}.${exhausted}`\r\n\t\t\tconst extras = this.level - 1\r\n\t\t\tif (extras > 0) {\r\n\t\t\t\tif (extras == 1) {\r\n\t\t\t\t\tmsg += ' Repeat for another ' + def.card + '.'\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmsg += ' Repeat ' + extras + ' times.'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn msg\r\n\t\t},\r\n\t\tlevelUpMessage () {\r\n\t\t\tif (maxLevel == 1) {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\t\t\treturn 'Put an extra copy into play.'\r\n\t\t},\r\n\t\trequires: def.requires,\r\n\t\trequiresHero: def.requiresHero,\r\n\t\tmaxLevel: maxLevel,\r\n\t\tcategory: category\r\n\t}\r\n\treturn upgrade\r\n}\r\n\r\nexport function generateExhaustedCardInPlay (def: ExhaustedCard) : Upgrade {\r\n\tconst category = defCategory(def)\r\n\tconst upgrade = {\r\n\t\tname: def.name,\r\n\t\tlevel: 1,\r\n\t\tdescription () {\r\n\t\t\tlet desc : string = cardInPlay(def.card, this.level == 1, def.article, def.they)\r\n\t\t\treturn desc\r\n\t\t},\r\n\t\trequires: def.requires,\r\n\t\tlevelUpMessage () {\r\n\t\t\treturn `Does not enter play exhausted`\r\n\t\t},\r\n\t\tmaxLevel: def.maxLevel || 2,\r\n\t\trequiresHero: def.requiresHero,\r\n\t\tcategory: category\r\n\t}\r\n\treturn upgrade\r\n}\r\n\r\nexport function generateCounterCardInPlay (def: CardInPlayExtraCounters) : Upgrade {\r\n\tlet maxLevel = def.maxLevel\r\n\r\n\t// If no max level has been provided, but we have defined the extra counters you would\r\n\t// get at each level, then we can use that to determine max level\r\n\tif (!def.maxLevel && def.extraCounters && typeof def.extraCounters == 'object') {\r\n\t\tdef.maxLevel = Object.keys(def.extraCounters).length\r\n\t}\r\n\r\n\tconst upgrade = {\r\n\t\tname: def.name,\r\n\t\tgetExtraCounters (level: number) {\r\n\t\t\treturn def.extraCounters[level] || 0\r\n\t\t},\r\n\t\textraCountersMsg (extraCounters: number) {\r\n\t\t\tconst extra = extraCounters == 1 ? '' : (extraCounters + ' ')\r\n\t\t\tif (extraCounters == 1) {\r\n\t\t\t\treturn `Put an extra counter on ` + def.pronoun + '.'\r\n\t\t\t}\r\n\t\t\treturn 'Put ' + extra + ' extra counters on ' + def.pronoun + '.'\r\n\t\t},\r\n\t\tlevel: 1,\r\n\t\tmaxLevel: def.maxLevel,\r\n\t\tdescription () {\r\n\t\t\tlet desc : string = cardInPlay(def.card, def.exhausted, def.article, def.they)\r\n\t\t\tconst extraCounters = this.getExtraCounters(this.level)\r\n\t\t\tif (extraCounters > 0) {\r\n\t\t\t\tdesc += ' ' + this.extraCountersMsg(extraCounters)\r\n\t\t\t}\r\n\t\t\treturn desc\r\n\t\t},\r\n\t\trequires: def.requires,\r\n\t\trequiresHero: def.requiresHero,\r\n\t\tlevelUpMessage () {\r\n\t\t\tconst currentCounters = this.getExtraCounters(this.level)\r\n\t\t\tconst newCounters = this.getExtraCounters(this.level+1)\r\n\t\t\tif (currentCounters == 0 && newCounters > 0) {\r\n\t\t\t\treturn this.extraCountersMsg(newCounters)\r\n\t\t\t}\r\n\r\n\t\t\treturn `Extra counters: ${currentCounters} becomes <strong>${newCounters}</strong>`\r\n\t\t},\r\n\t\tcategory: defCategory(def),\r\n\t\tconflictingHeroes: def.conflictingHeroes\r\n\t}\r\n\treturn upgrade\r\n}\r\n\r\nexport function generateAllyCard (def: MinionCard) : Upgrade {\r\n\tconst upgrade = {\r\n\t\tname: def.name,\r\n\t\tgetDamageCounters (level: number) {\r\n\t\t\tif (def.levels && def.levels[level-1]) {\r\n\t\t\t\treturn def.levels[level-1].damage || 0\r\n\t\t\t}\r\n\t\t\treturn 0\r\n\t\t},\r\n\t\tdamageCountersMsg (counters: number) {\r\n\t\t\tif (counters == 0) {\r\n\t\t\t\treturn ''\r\n\t\t\t}\r\n\t\t\treturn def.card + ` starts with ${counters} damage counter` + (counters == 1 ? '' : 's') + ' on ' + def.pronoun + '.'\r\n\t\t},\r\n\t\tlevel: 1,\r\n\t\tmaxLevel: def.levels.length,\r\n\t\tdescription () {\r\n\t\t\tlet desc = `<strong>Setup:</strong> Put <strong>${def.card}</strong> into play under your control.`\r\n\t\t\tif (def.levels[this.level-1].exhausted) {\r\n\t\t\t\tdesc += ` ${def.card} enters play exhausted.`\r\n\t\t\t}\r\n\t\t\tconst dmg = this.getDamageCounters(this.level)\r\n\t\t\tif (dmg > 0) {\r\n\t\t\t\tdesc += ' ' + this.damageCountersMsg(dmg)\r\n\t\t\t}\r\n\t\t\tif (this.isTough(this.level)) {\r\n\t\t\t\tdesc += ` Give ${def.pronoun} a Tough status card.`\r\n\t\t\t}\r\n\t\t\treturn desc\r\n\t\t},\r\n\t\tisTough (level: number) : boolean {\r\n\t\t\treturn def.levels[level-1].tough || false\r\n\t\t},\r\n\t\trequires: def.requires,\r\n\t\trequiresHero: def.requiresHero,\r\n\t\tlevelUpMessage () {\r\n\t\t\tconst current = def.levels[this.level-1]\r\n\t\t\tconst next = def.levels[this.level]\r\n\t\t\tconst parts = []\r\n\t\t\tif (current.damage != next.damage) {\r\n\t\t\t\tparts.push(`Starting Damage: ${current.damage} becomes <strong>${next.damage}</strong>`)\r\n\t\t\t}\r\n\t\t\tif (next.tough) {\r\n\t\t\t\tparts.push('Gains a Tough status card.')\r\n\t\t\t}\r\n\t\t\tif (current.exhausted && !next.exhausted) {\r\n\t\t\t\tparts.push('Does not enter play exhausted.')\r\n\t\t\t}\r\n\t\t\treturn parts.join(' ')\r\n\t\t},\r\n\t\tcategory: defCategory(def),\r\n\t\tconflictingHeroes: def.conflictingHeroes\r\n\t}\r\n\treturn upgrade\r\n}\r\n\r\nexport function cardInPlay(card: string, exhausted = false, article = 'a', they = 'It') : string {\r\n\tconst articleMsg = article ? (article + ' ') : ''\r\n\tlet desc = `<strong>Setup:</strong> Put ${articleMsg}<strong>${card}</strong> into play under your control.`\r\n\tif (exhausted) {\r\n\t\tdesc += ` ${they} enters play exhausted.`\r\n\t}\r\n\treturn desc\r\n}\r\n\r\nexport function levelUpMessageIncrease (numBefore: number, numAfter: number, numOfWhat: string, plural?: string) : string {\r\n\tif (!plural) {\r\n\t\tplural = numOfWhat + 's'\r\n\t}\r\n\treturn `${numBefore} ${numBefore == 1 ? numOfWhat : plural} becomes <strong>${numAfter} ${plural}</strong>`\r\n}\r\n\r\n"],"sourceRoot":""}]}